<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This crate exposes client functionality to rapidly sync gossip data, aimed primarily at mobile devices."><meta name="keywords" content="rust, rustlang, rust-lang, lightning_rapid_gossip_sync"><title>lightning_rapid_gossip_sync - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../lightning_rapid_gossip_sync/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../lightning_rapid_gossip_sync/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate lightning_rapid_gossip_sync</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.0.113</li><li><a id="all-types" href="all.html">All Items</a></li></ul></div><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../lightning_rapid_gossip_sync/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">lightning_rapid_gossip_sync</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/lightning_rapid_gossip_sync/lib.rs.html#2-315">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This crate exposes client functionality to rapidly sync gossip data, aimed primarily at mobile
devices.</p>
<p>The rapid gossip sync server will provide a compressed response containing differential gossip
data. The gossip data is formatted compactly, omitting signatures and opportunistically
incremental where previous channel updates are known. This mechanism is enabled when the
timestamp of the last known channel update is communicated. A reference server implementation
can be found <a href="https://github.com/lightningdevkit/rapid-gossip-sync-server">on Github</a>.</p>
<p>The primary benefit of this syncing mechanism is that it allows a low-powered client to offload
the validation of gossip signatures to a semi-trusted server. This enables the client to
privately calculate routes for payments, and to do so much faster than requiring a full
peer-to-peer gossip sync to complete.</p>
<p>The server calculates its response on the basis of a client-provided <code>latest_seen</code> timestamp,
i.e., the server will return all rapid gossip sync data it has seen after the given timestamp.</p>
<h2 id="getting-started"><a href="#getting-started">Getting Started</a></h2>
<p>Firstly, the data needs to be retrieved from the server. For example, you could use the server
at <a href="https://rapidsync.lightningdevkit.org">https://rapidsync.lightningdevkit.org</a> with the following request format:</p>
<div class="example-wrap"><pre class="language-shell"><code>curl -o rapid_sync.lngossip https://rapidsync.lightningdevkit.org/snapshot/&lt;last_sync_timestamp&gt;</code></pre></div>
<p>Note that the first ever rapid sync should use <code>0</code> for <code>last_sync_timestamp</code>.</p>
<p>After the gossip data snapshot has been downloaded, one of the client’s graph processing
functions needs to be called. In this example, we process the update by reading its contents
from disk, which we do by calling <a href="struct.RapidGossipSync.html#method.update_network_graph" title="RapidGossipSync::update_network_graph"><code>RapidGossipSync::update_network_graph</code></a>:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>bitcoin::blockdata::constants::genesis_block;
<span class="kw">use </span>bitcoin::Network;
<span class="kw">use </span>lightning::routing::gossip::NetworkGraph;
<span class="kw">use </span>lightning_rapid_gossip_sync::RapidGossipSync;


<span class="kw">let </span>block_hash = genesis_block(Network::Bitcoin).header.block_hash();
<span class="kw">let </span>network_graph = NetworkGraph::new(block_hash, <span class="kw-2">&amp;</span>logger);
<span class="kw">let </span>rapid_sync = RapidGossipSync::new(<span class="kw-2">&amp;</span>network_graph);
<span class="kw">let </span>snapshot_contents: <span class="kw-2">&amp;</span>[u8] = <span class="kw-2">&amp;</span>[<span class="number">0</span>; <span class="number">0</span>];
<span class="kw">let </span>new_last_sync_timestamp_result = rapid_sync.update_network_graph(snapshot_contents);</code></pre></div>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RapidGossipSync.html" title="lightning_rapid_gossip_sync::RapidGossipSync struct">RapidGossipSync</a></div><div class="item-right docblock-short">The main Rapid Gossip Sync object.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.GraphSyncError.html" title="lightning_rapid_gossip_sync::GraphSyncError enum">GraphSyncError</a></div><div class="item-right docblock-short">All-encompassing standard error type that processing can return</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="lightning_rapid_gossip_sync" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.65.0 (897e37553 2022-11-02)" ></div></body></html>